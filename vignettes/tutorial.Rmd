
---
title: "Project 3: myfirstpackage Tutorial"
author: "Jack L Griffin"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{myfirstpackage Tutorial}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(myfirstpackage)
```

This package is a data analysis package including a few functions that can help the user better understand and interpret their data. my_t.test performs a simple t-test, my_lm creates a linear model, my_knn_cv makes a prediction of classification based on data, and my_rf_cv predicts object variables based on covariates. The following code will install the package from github:

```{r, eval = FALSE}
# install.packages("devtools")
library(devtools)
# devtools::install_github("jacklorrengriffin/myfirstpackage")
library(myfirstpackage)
```


load gapminder data for tutorials
```{r}
data(my_gapminder)
```

my_t.test tutorial

```{r}
my_t.test(my_gapminder$lifeExp, "two.sided", 60)
my_t.test(my_gapminder$lifeExp, "less", 60)
my_t.test(my_gapminder$lifeExp, "greater", 60)
```



my_lm tutorial

```{r}
my_lm(lifeExp ~ gdpPercap + continent, my_gapminder)

library(ggplot2)
lm_output <- predict(lm(lifeExp ~ gdpPercap + continent, my_gapminder))
comparison <- data.frame(my_gapminder[["lifeExp"]], lm_output)

ggplot(data = comparison, aes(x = life_expectancy, y = lm_output))
```

my_knn_cv tutorial

```{r}
data(my_penguins)

train <- na.omit(my_penguins)[,3:6]
cl <- na.omit(my_penguins)[1]

k1 <- my_knn_cv(train, cl, 1, 5)
k2 <- my_knn_cv(train, cl, 2, 5)
k3 <- my_knn_cv(train, cl, 3, 5)
k4 <- my_knn_cv(train, cl, 4, 5)
k5 <- my_knn_cv(train, cl, 5, 5)
k6 <- my_knn_cv(train, cl, 6, 5)
k7 <- my_knn_cv(train, cl, 7, 5)
k8 <- my_knn_cv(train, cl, 8, 5)
k9 <- my_knn_cv(train, cl, 9, 5)
k10 <- my_knn_cv(train, cl, 10, 5)
knn_results <- c(k1, k2, k3, k4, k5, k6, k7, k8, k9, k10)

print(knn_results)
```

my_rf_cv tutorial

```{r}
cv_ests <- data.frame(rep(0, 90), rep(0, 90))
colnames(cv_ests) <- c("k", "cv")

for (i in 1:30) {
    cv_ests[i, 1] <- "2"
    cv_ests[i, 2] <- my_rf_cv(2)
}
for (i in 31:60) {
    cv_ests[i, 1] <- "5"
    cv_ests[i, 2] <- my_rf_cv(5)
}
for (i in 61:90) {
    cv_ests[i, 1] <- "10"
    cv_ests[i, 2] <- my_rf_cv(10)
}

ggplot(data = cv_ests, aes(x = k, y = cv_est, group = k)) +
  geom_boxplot() +
  labs(title = "k-Fold Cross-Validation Estimate") +
  theme_bw()

data_2 <- c(mean(cv_ests[which(cv_ests$k == "2"), ]$cv),
            sd(cv_ests[which(cv_ests$k == "2"), ]$cv))
data_5 <- c(mean(cv_ests[which(cv_ests$k == "5"), ]$cv),
            sd(cv_ests[which(cv_ests$k == "5"), ]$cv))
data_10 <- c(mean(cv_ests[which(cv_ests$k == "10"), ]$cv),
            sd(cv_ests[which(cv_ests$k == "10"), ]$cv))

table <- matrix(c(data_2, data_5, data_10), nrow = 3, ncol = 2, byrow = TRUE)
rownames(table) <- c("k = 2", "k = 5", "k = 10")
colnames(table) <- c("Mean", "SD")
as.table(table)
```
